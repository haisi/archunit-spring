= ArchUnit Spring Integration

The ArchUnit Spring Integration is a small library to simplify writing https://github.com/TNG/ArchUnit[ArchUnit] tests for https://spring.io/projects[Spring] applications.

== Usage

[source,xml]
----
<dependency>
    <groupId>de.rweisleder</groupId>
    <artifactId>archunit-spring</artifactId>
    <version>0.1.0</version>
    <scope>test</scope>
</dependency>
----

The library expects that the required dependencies for Spring and ArchUnit are already declared.

Compatible with:

* Java 8+
* ArchUnit 1.0+
* Spring Framework 5.2+ / Spring Boot 2.2+

== Examples

Given the following class:
[source,java]
----
@RestController
class DemoRestController {

    @GetMapping("/hello")
    String hello() {
        return "Hello World";
    }
}
----

You can write architecture rules like this:

[source,java]
----
import static de.rweisleder.archunit.spring.MergedAnnotationPredicates.springAnnotatedWith;

// "methods that are annotated with @RequestMapping (or @GetMapping, @PostMapping etc.)
//  should be declared in classes that are annotated with @Controller (or @RestController etc.)"
methods()
    .that(are(
        springAnnotatedWith(RequestMapping.class)
            .as("annotated with @RequestMapping (or @GetMapping, @PostMapping etc.)"))
    )
    .should().beDeclaredInClassesThat(are(
        springAnnotatedWith(Controller.class)
            .as("annotated with @Controller (or @RestController etc.)")
    ));


// "methods that are annotated with @RequestMapping (or @GetMapping, @PostMapping etc.)
//  should have path containing only lowercase characters"
methods()
    .that(
        are(springAnnotatedWith(RequestMapping.class)
            .as("annotated with @RequestMapping (or @GetMapping, @PostMapping etc.)"))
    )
    .should(
        be(springAnnotatedWith(RequestMapping.class,
            describe("@RequestMapping(path=<lower-case>)",
                requestMapping -> Arrays.stream(requestMapping.path()).allMatch(path -> path.toLowerCase().equals(path))))
        ).as("have path containing only lowercase characters")
    );
----
